// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// 1. 데이터베이스 설정 (MySQL)
datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL") // .env 파일의 DATABASE_URL을 사용
}

// 2. Prisma Client 생성기 (Node.js용)
generator client {
  provider = "prisma-client-js"
}

// 3. 데이터 모델 (DB 테이블 설계도)
// (아까 대화에서 User, EmailVerificationCode 테이블이 언급되어 추가했습니다.)

model User {
  id                String    @id @default(cuid())
  name              String?
  email             String?   @unique
  emailVerifiedAt   DateTime?
  passwordHash      String?   // 소셜 로그인은 비번이 없을 수 있음
  googleId          String?   @unique // 구글 ID 저장용

  resetPasswordToken String?   @unique 
  resetPasswordExpires DateTime?
  
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
}

model EmailVerificationCode {
  id        String   @id @default(cuid())
  email     String
  code      String   @unique
  expiresAt DateTime

  used      Boolean  @default(false) // 코드 사용 여부 추적용
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([email, code])
}

// 이메일 인증번호(6자리)를 임시로 저장하는 테이블
model VerificationToken {
  identifier String   // 인증할 이메일 주소 (예: you@example.com)
  token      String   // 발송된 6자리 인증번호 (예: 123456)
  expires    DateTime // 인증번호 만료 시간 (5분 뒤)

  // 이메일과 토큰의 조합은 유일해야 함 (중복 방지)
  @@unique([identifier, token])
}